cmake_minimum_required(VERSION 2.8)
set(CMAKE_CXX_FLAGS "-std=c++11 -O2 -DNDEBUG -Wno-c++11-narrowing -Wno-conversion" )

set(OPENCV   ON)
set(GPU      ON)
set(BUILDLIB OFF)

find_package(OpenCV)

set( CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${PROJECT_SOURCE_DIR} )
find_package(OpenCL)

if (OpenCL_FOUND AND GPU)
	ADD_DEFINITIONS(-DGPU=1)
	include_directories(${OpenCL_INCLUDE_DIR})
	link_libraries(${OpenCL_LIBRARY})
	link_libraries(/usr/local/lib/libclblast.so)
endif()

if (OpenCV_FOUND AND OPENCV)
	ADD_DEFINITIONS(-DOPENCV)
	include_directories(${OpenCV_INCLUDE_DIR})
	link_libraries(${OpenCV_LIBRARIES})
endif()

aux_source_directory(./darknet_cl/src DIR_LIB_SRC)
aux_source_directory(./darknet_cl/example DIR_EXAMPLE_SRC)

include_directories(./darknet_cl/include)

link_libraries(/usr/lib/libSystem.B.dylib)
# link_libraries(/usr/lib/libpthread.dylib)

if (BUILDLIB)
	add_library(darknet SHARED ${DIR_LIB_SRC})
else(BUILDLIB)
	add_executable(darknet ${DIR_LIB_SRC} ${DIR_EXAMPLE_SRC})
endif()
